
{% extends "base.html" %}

{% block content %}
<a href="/league" class="back-link">‚Üê Back to League Explorer</a>

<div class="player-page">

  <div class="player-header">
    <img src="{{ stats.img }}" class="headshot" alt="{{ player_name }} headshot">
    <div class="player-meta">
      <h1 class="player-name-page" id="player-name">{{ player_name }}</h1>
      <p class="player-team" id="team">{{ team }}</p>
      <span id="season" style="display:none;">{{ season }}</span>
    </div>
  </div>

  <div class="player-stats-roles">
    <div class="card player-stats">
      <h2>Basic Stats</h2>
      <ul>
        <li><strong>Points:</strong> {{ stats.points }}</li>
        <li><strong>FG%:</strong> {{ stats.fg_pct }}</li>
        <li><strong>Minutes:</strong> {{ stats.minutes }}</li>
        <li><strong>Passes Made:</strong> {{ stats.passes_made }}</li>
        <li><strong>Passes Received:</strong> {{ stats.passes_received }}</li>
        <li><strong>Pass Ratio:</strong>
          {% if stats.passes_received %}
            {{ (stats.passes_made / stats.passes_received) | round(2) }}
          {% else %}
            N/A
          {% endif %}
        </li>
      </ul>
    </div>
<div class="card player-roles">
  <h2>Role Scores</h2>
  <div class="toggle-container">
  <label class="toggle-label flex">
    <input type="checkbox" id="normalize-toggle">
    <span class="custom-toggle"></span>
    Normalize by League Avg
  </label>
  </div>
  <div class="chart-container">
    <canvas id="roleRadarChart"></canvas>
  </div>
</div>
  </div>

  <div class="player-visuals-grid">
    <div class="card">
      <h2>Passing Network</h2>
      <div id="player-network"></div>
    </div>
    <div class="card">
      <h2>Shot Chart</h2>
      <svg id="court-svg" width="431" height="405.14" viewBox="0 0 431 405.14"></svg>
    </div>
  </div>

</div>

<script id="player-edges-data" type="application/json">{{ edges | tojson }}</script>
<script id="player-nodes-data" type="application/json">{{ nodes | tojson }}</script>
<script>
  window.roleStats = {
    player: {
      hub: parseFloat("{{ stats.hub_score or 0 }}"),
      distributor: parseFloat("{{ stats.distributor_score or 0 }}"),
      finisher: parseFloat("{{ stats.finisher_score or 0 }}"),
      black_hole: parseFloat("{{ stats.black_hole_score or 0 }}")
    },
    league: {
      hub: parseFloat("{{ league_avg.hub_score or 1 }}"),
      distributor: parseFloat("{{ league_avg.distributor_score or 1 }}"),
      finisher: parseFloat("{{ league_avg.finisher_score or 1 }}"),
      black_hole: parseFloat("{{ league_avg.black_hole_score or 1 }}")
    }
  };
</script>

<script type="module" src="{{ url_for('static', filename='player.js') }}"></script>

{% endblock %}



